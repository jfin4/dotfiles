# vim: set ft=sh:
##############################################################################
#                                  options                                   #
##############################################################################

set -o emacs
bind ^l=clear-screen

##############################################################################
#                                 environment                                #
##############################################################################

HISTFILE=~/.histfile
HISTSIZE=10000
SAVEHIST=10000

PS1=\
$'\$(x=\$?; (( x )) && print "\1\e[31m:( $x\n\1\e[0m")\n'\
$'\$([ $TMUX ] && print "\1\e[1;30mtmux \1\e[0m")'\
$'\$((( USER_ID)) && print "\1\e[1;30m$ \1\e[0m" || print "\1\e[30m# \1\e[0m")'\
 
# $'\1\e[1;30m\$PWD/\1\e[0m\n'\

date="$(date +'%Y-%m-%d')"

##############################################################################
#                                functions                                   #
##############################################################################

# here because history is disabled in scripts
rr() {
    local copy=0
    if [ "$1" == "." ]
    then
        copy=1
        shift
    fi
    
    # awk trims and squeezes
    command=$(fc -l -n 1\
        | awk '{$1=$1; print}'\
        | grep -a "${1:-.}"\
        | fzy)

    if [ "$copy" -eq 1 ]
    then
        tmux send-keys "$command"
        echo
    else
        $command
    fi
}

##############################################################################
#                                 aliases                                    #
##############################################################################

alias R='start-r'
alias ZZZ='systemctl hibernate'
alias bak='backup-file'
alias d='date "+%H:%M"'
alias d='pwd'
alias dot='git --git-dir=$HOME/.dotfiles.git/ --work-tree=$HOME'
alias dott='sync-dot-repo'
alias fd='wrap-find'
alias ff='fuzzy-find-file'
alias focus='play-sounds'
alias gitt='sync-repo'
alias gittt='sync-all-repos'
alias hp='connect-headphones'
alias install='sudo pacman -S'
alias jot='take-notes'
alias kb='show-key-bindings'
alias krc='vim ~/.mkshrc; . ~/.mkshrc'
alias la='ls -AlhF'
alias ll='ls -lhF'
alias lynx="lynx -cfg=$HOME/.lynx/lynx.cfg -lss=$HOME/.lynx/lynx.lss"
alias mcam='sudo mount /dev/disk/by-label/camera /mnt/camera/'
alias mnas='sshfs rp:/mnt /mnt/nas'
alias mthumb='sudo mount /dev/disk/by-label/thumb /mnt/thumb/'
alias mvv='rename-files'
alias p='pwd'
alias pad='toggle-numpad'
alias play='mpv'
alias reboot='sudo reboot'
alias remove='sudo pacman -R'
alias search='sudo pacman -Ss'
alias shutdown='sudo halt -p'
alias sshr='ssh root@192.168.1.1'
alias t='date "+%l:%M" | tr -d " "'
alias tmux='start-tmux'
alias tp='move-to-trash'
alias trc='vim ~/.tmux.conf; tmux source-file ~/.tmux.conf'
alias ubak='restore-file'
alias ucam='sudo umount /mnt/camera/'
alias unas='fusermount3 -u /mnt/nas'
alias update='sudo pacman -Syu'
alias uthumb='sudo umount /mnt/thumb/'
alias ydl='download-playlist'
alias zzz='systemctl suspend'

